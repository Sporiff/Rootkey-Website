

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-gb" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en-gb" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Deploying and Controlling Google Chrome Settings Using Microsoft Intune &mdash; Rootkey 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Microsoft Teams Deployment Headaches" href="2018-07-14-microsoft-teams-deployment-headaches.html" />
    <link rel="prev" title="New Site" href="2018-10-01-new-site.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Rootkey
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../blog/index.html">My Blog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Technology</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2019-04-25-matrix-is-here.html">Matrix is Here</a></li>
<li class="toctree-l2"><a class="reference internal" href="2019-02-05-goodbye-guix.html">Goodbye, Guix</a></li>
<li class="toctree-l2"><a class="reference internal" href="2019-02-04-tanuki-tunes-update.html">Tanuki Tunes Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="2019-01-11-baku-social-news.html">Baku Social News</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-12-22-bakusocial.html">Baku Social</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-10-25-thermy.html">Thermy</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-10-23-elementary-juno.html">Elementary OS Juno</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-10-06-apple-drink-cider.html">Apple: Drink the Cider</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-10-02-personal-matters.html">Personal Matters</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-10-01-new-site.html">New Site</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Deploying and Controlling Google Chrome Settings Using Microsoft Intune</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ingesting-admx-templates">Ingesting ADMX Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-boy-to-do">What is a Boy to do?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2018-07-14-microsoft-teams-deployment-headaches.html">Microsoft Teams Deployment Headaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-06-16-back-to-the-drawing-board.html">Back to the Drawing Board</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-06-02-some-more-windows-work.html">Some More Windows Work</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-20-getting-on-with-gutenberg.html">Getting on With Gutenberg</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-15-knit-and-perl.html">Knit and Perl</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-14-pgp-problems-promise-pounding-headaches.html">PGP Problems Promise Pounding Headaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-13-a-reluctant-return-to-windows.html">A Reluctant Return to Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-10-acclimatising-to-new-tech.html">Acclimitising to New Tech</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-09-another-day-another-intel-fail.html">Another Day Another Intel Fail</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-08-uncontrolled-devices-not-even-once.html">Uncontrolled Devices: Not Even Once</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018-05-08-deploying-sophos-in-a-production-environment.html">Deploying Sophos in a Production environment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../music/index.html">Music I’ve Made</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About Me</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact Me</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Rootkey</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Technology</a> &raquo;</li>
        
      <li>Deploying and Controlling Google Chrome Settings Using Microsoft Intune</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tech/2018-07-27-deploying-and-controlling-google-chrome-settings-using-microsoft-intune.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deploying-and-controlling-google-chrome-settings-using-microsoft-intune">
<h1>Deploying and Controlling Google Chrome Settings Using Microsoft Intune<a class="headerlink" href="#deploying-and-controlling-google-chrome-settings-using-microsoft-intune" title="Permalink to this headline">¶</a></h1>
<p>Righto. This one has given me a mild headache for the last couple of days, but I’ve found a workable
solution that allows me to set a home page for users in Chrome. You would have thought that would be
really easy, right? Well, Google in its infinite wisdom has decided that conventional Windows management
is for wusses. So down the rabbit hole we go.</p>
<div class="section" id="ingesting-admx-templates">
<h2>Ingesting ADMX Templates<a class="headerlink" href="#ingesting-admx-templates" title="Permalink to this headline">¶</a></h2>
<p>Let us say, for the sake of argument, that you have deployed the Chrome Enterprise <code class="docutils literal notranslate"><span class="pre">.msi</span></code> to your devices
either during a build or using Intune. Now you want to control some of the settings for your users in order
to provide a consistent experience. If you look around online, you’ll see various references to ingesting
ADMX templates and leveraging these for using with Chrome. This looks something like this:</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>* Create an OMA-URI to import your ADMX template
    * ./Device/Vendor/MSFT/Policy/ConfigOperations/ADMXInstall/Chrome/Policy/ChromeADMX}
    * Data Type = String
    * Value = the whole body of the Chrome ADMX template
* Leverage policies from within this template using nested OMA-URI settings
    * ./Device/Vendor/MSFT/Policy/Config/Chrome~Policy~googlechrome/ShowHomeButton
    * Data Type = String
    * Value = <span class="p">&lt;</span>enabled/&gt;
</pre></div>
</div>
<p>Pretty simple stuff. This allows us to show the home button. Tickedy boo. So what about setting the home
page and landing pages for users? Well, unfortunately, this isn’t possible.</p>
<p>When you use the CSP settings to load and edit the GPO locally, Chrome detects that the computer is not
connected to an on-prem AD, and will ignore certain settings including but not limited to your custom home
page. Bum gravy. This is mentioned in some capacity in <a class="reference external" href="https://bugs.chromium.org/p/chromium/issues/detail?id=433112">this thread</a>
 and in <a class="reference external" href="https://www.chromium.org/administrators/policy-list-3#HomepageLocation">this advisory</a>, but it’s far from a
satisfactory explanation in an Azure AD connected world.</p>
</div>
<div class="section" id="what-is-a-boy-to-do">
<h2>What is a Boy to do?<a class="headerlink" href="#what-is-a-boy-to-do" title="Permalink to this headline">¶</a></h2>
<p>So here’s the dilemma. I know that another way to control Chrome is using a file called <code class="docutils literal notranslate"><span class="pre">master_preferences</span></code>
located in the <code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files</span> <span class="pre">(x86)\Google\Chrome\Application</span></code> folder, so for future deployments it would be
entirely possible to simply place this in the image. However, we have nearly 60 devices already out in the world
due to the unreal pressure we’ve been under to deliver, so I need a remote deployment method.</p>
<p>First option is to use Powershell. Powershell could easily be pointed at a publicly accessible Azure blob containing
the <code class="docutils literal notranslate"><span class="pre">master_preferences</span></code> file. The problem with this is that Powershell scripts can only be targeted at users,
which would mean that in the long run we would not be able to set different preferences on different types of machines.</p>
<p>So, what about a <code class="docutils literal notranslate"><span class="pre">.msi</span></code> file? I got this idea in my head to package the file up as an application, which would give
us the power not only to deploy per device but also to supersede if we ever want to make changes to the config.
The two tools I used to achieve this were <a class="reference external" href="http://nsis.sourceforge.net/Download">NSIS</a> and the free version of
<a class="reference external" href="https://www.exemsi.com/download/">exemsi</a>. The steps are as follows:</p>
<ul class="simple">
<li><p>Edit your <code class="docutils literal notranslate"><span class="pre">master_preferences</span></code> file to reflect the changes you want to make</p></li>
<li><p>Place the file in a zip archive</p></li>
<li><p>Run NSIS and select “Installer based on ZIP file”</p></li>
<li><p>Select your ZIP file, give the installer a suitable name, and set the”Default Folder” value to <code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files</span> <span class="pre">(x86)\Google\Chrome\Application</span></code></p></li>
<li><p>Hit “Generate” and locate your newly created <code class="docutils literal notranslate"><span class="pre">.exe</span></code> file</p></li>
<li><p>Next, open up exemsi and click “Next” to start the wizard</p></li>
<li><p>Select your newly created executable and change the <code class="docutils literal notranslate"><span class="pre">.msi</span></code> name if desired</p></li>
<li><p>In the installer options, select “Per Machine” under “MSI installation context”. This is required to allow you to deploy to devices as opposed to users. If users are your targets, set this to “Per User”</p></li>
<li><p>Give your application and ID and generate an Upgrade Code. This will allow you to uninstall and supersede if needs be, so keep a note of it and use the same code for any new iterations. Intune will notify you if the codes do not match</p></li>
<li><p>Enter some information about the product including the name, the manufacturer, and the version number</p></li>
<li><p>Optionally, set up contact links</p></li>
<li><p>For install and uninstall arguments, use the flag “/S” (make sure this is capital). This is the standard NSIS silent install flag</p></li>
<li><p>There is no need to enter any before/after command lines</p></li>
<li><p>Hit “Build” at the end and it will generate a <code class="docutils literal notranslate"><span class="pre">.msi</span></code></p></li>
</ul>
<p>After this, upload your <code class="docutils literal notranslate"><span class="pre">.msi</span></code> to Intune, deploy it to a test group, and watch the magic happen. Please note that
you cannot deploy the ADMX template and the <code class="docutils literal notranslate"><span class="pre">master_preferences</span></code> file at the same time as the two conflict with one another.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="2018-07-14-microsoft-teams-deployment-headaches.html" class="btn btn-neutral float-right" title="Microsoft Teams Deployment Headaches" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="2018-10-01-new-site.html" class="btn btn-neutral float-left" title="New Site" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Ciarán Ainsworth

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>